<html>
<script>
function getTime(dateString)
{
var date = new Date(dateString);
return date.getTime();
}

var entries = [];

function sortByDate(a, b) {
    if (a[0] > b[0])
	return 1;
else return 0;
}

function updatepage(str, feed_name, index){
var yahooFormatted = JSON.parse(str);
var myobj = yahooFormatted.query.results;

for (i=0; i < myobj.item.length; i++)
{

var theEntry = '<a href="' + myobj.item[i].link + '">' + myobj.item[i].title + '</a>' + '<br>(' + feed_name + ": " + myobj.item[i].pubDate +')' + "<br>";
entries.push([getTime(myobj.item[i].pubDate), theEntry]);
}

//document.body.innerHTML = JSON.stringify(myobj.item);

}

function xmlhttpPost(strURL, feed_name, index) {
    var url = strURL;

//here we use yahoo yql as a cors proxy
var newurl = 'https://query.yahooapis.com/v1/public/yql?q=';
var yqlquery = "select title,link,pubDate from rss where url='" + url + "'"

    var xmlHttpReq = false;
    var self = this;
    if (window.XMLHttpRequest) { // Mozilla/Safari
        self.xmlHttpReq = new XMLHttpRequest();
    }
    else if (window.ActiveXObject) { // IE
        self.xmlHttpReq = new ActiveXObject("Microsoft.XMLHTTP");
    }
    self.xmlHttpReq.open('POST', newurl + escape(yqlquery) + "&format=json", false);
//alert(newurl+escape(yqlquery)+"&format=json");
    self.xmlHttpReq.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
    self.xmlHttpReq.onload = function() {
        if (self.xmlHttpReq.status == 200) {
            updatepage(self.xmlHttpReq.responseText, feed_name, index);
        }
    }

    self.xmlHttpReq.send();
}

function aggregate(){
var feed_urls = [
"http://www.dailystar.co.uk/rss/1/news/",
"http://www.huffingtonpost.com/feeds/verticals/uk/news.xml",
"https://www.theguardian.com/uk-news/rss",
"https://news.google.co.uk/news?hl=en&amp;pz=1&amp;ned=uk",
"http://www.bbc.co.uk/news/",
"http://www.express.co.uk/posts/rss/1/uknews",
"http://www.telegraph.co.uk/news/uknews/rss",
"http://www.scotsman.com/cmlink/1.957142",
"http://www.thisislondon.co.uk/news/rss",
"http://twitter.com/statuses/user_timeline/68672354.rss",
"http://www.independent.co.uk/news/uk/rss",
"http://news.sky.com/sky-news/rss/uk-news/rss.xml",
"http://timesofindia.indiatimes.com/rssfeeds/2177298.cms",
"http://www.dailymail.co.uk/news/index.rss",
"http://www.trinitymirror.com/atom.xml",
"http://www.metro.co.uk/rss/news",
"https://uk.news.yahoo.com/rss",
"https://www.thesun.co.uk/news/feed/"
]

var feed_names = [
"The Daily Star",
"Huffington Post",
"The Guardian",
"Google News",
"The BBC",
"The Express",
"The Telegraph",
"The Scotsman",
"The Evening Standard",
"Twitter",
"The Independent",
"Sky",
"The Times Of India",
"The Daily Mail",
"Trinity Mirror",
"The Metro",
"Yahoo",
"The Sun"
]

	for (index=0; index < feed_urls.length; ++index)
	{
		xmlhttpPost(feed_urls[index], feed_names[index], index)
	}

entries.sort(function(a, b) {
    return ((b[0] < a[0]) ? -1 : ((b[0] == a[0]) ? 0 : 1));
});
//entries.sort(sortByDate);

var newsout = "";
	for (index2=0; index2 < entries.length; ++ index2)
	{
		newsout = newsout + entries[index2][1];
	}
document.getElementById("theNews").innerHTML = "<center>" + newsout + "</center>";
}

</script>
<center>
<h2>All News:</h2>
<body onload="aggregate();">
<div id="theNews">Loading...</div>
</body>
</center>
</html>